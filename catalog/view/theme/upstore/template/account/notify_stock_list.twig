{{ header }}
<div class="container">
    <ul class="breadcrumb">
        {% for i, breadcrumb in breadcrumbs %}
            {% if i + 1 < breadcrumbs|length %}
                <li><a href="{{ breadcrumb.href }}"><span>{{ breadcrumb.text }}</span></a></li>
            {% else %}
                <li><span>{{ breadcrumb.text }}</span></li>
            {% endif %}
        {% endfor %}
    </ul>
    <h1>{{ heading_title }}</h1>
    {% if success %}
        <div class="alert ch-alert-success">
            <img class="success-icon" alt="success-icon" src="catalog/view/theme/upstore/image/success-icon.svg">
            <div class="text-modal-block">{{ success }}</div>
            <button type="button" class="close" data-dismiss="alert"><i class="up-icon-close" aria-hidden="true"></i></button>
        </div>
    {% endif %}
    <div class="row-flex">
        {{ column_left }}
        {% if column_left and column_right %}
            {% set class = 'col-sm-6' %}
        {% elseif column_left or column_right %}
            {% set class = 'col-sm-9' %}
        {% else %}
            {% set class = 'col-sm-12' %}
        {% endif %}
        <div id="content" class="{{ class }}">
            {{ content_top }}
            <div class="chm-account-content h-100">
                {% if waitlist_requests %}
                    <div class="table-responsive">
                        <table class="table ch-table">
                            <thead>
                                <tr>
                                    <td class="text-left">{{ column_image }}</td>
                                    <td class="text-left">{{ column_name }}</td>
                                    <td class="text-right">{{ column_date_added }}</td>
                                    <td class="text-right">{{ column_status }}</td>
                                    <td class="text-right"></td>
                                </tr>
                            </thead>
                            <tbody>
                                {% for request in waitlist_requests %}
                                    <tr>
                                        <td class="text-left"><img class="img-thumbnail" src="{{ request.product_image }}" alt="{{ request.product_name }}"></td>
                                        <td class="text-left"><a href="{{ request.href }}">{{ request.product_name }}</a></td>
                                        <td class="text-right">{{ request.date_added }}</td>
                                        <td class="text-right">{{ request.status }}</td>
                                        <td class="text-right">
                                            <button type="button" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-remove" onclick="removeNotifyRequest('{{ request.notify_stock_id }}');">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                                    <polyline points="3 6 5 6 21 6"></polyline>
                                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                    <line x1="10" y1="11" x2="10" y2="17"></line>
                                                    <line x1="14" y1="11" x2="14" y2="17"></line>
                                                </svg>
                                            </button>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 text-center">{{ pagination }}</div>
                        <div class="col-sm-12 text-center">{{ results }}</div>
                    </div>
                {% else %}
                    <div class="chm-text-empty">{{ text_empty }}</div>
                {% endif %}
            </div>
            {{ content_bottom }}
        </div>
        {{ column_right }}
    </div>
</div>
{% if waitlist_requests %}
<script>
    function removeNotifyRequest(notify_stock_id) {
        $.ajax({
            url: 'index.php?route=account/notify_stock/remove',
            type: 'POST',
            data: {
                'notify_stock_id': notify_stock_id
            },
            dataType: 'json',
            beforeSend: function() {
                creatOverlayLoadPage(true);
                $('.alert.ch-alert-danger').remove();
            },
            success: function(json) {
                if (json['error']) {
                    $('body').append('<div class="alert ch-alert-danger mh-100"><img class="success-icon" alt="warning-icon" src="catalog/view/theme/upstore/image/warning-icon.svg"><div class="text-modal-block">' + json['error'] + '</div><button type="button" class="close" data-dismiss="alert">&times;</button></div>');
                }
                if (json['success']) {
                    location = 'index.php?route=account/notify_stock';
                }
                if (json['redirect']) {
                    location = json['redirect'];
                }
            },
            error: function() {
                alert('Error remove request');
            }
        });
    }
</script>
{% endif %}
{{ footer }}
