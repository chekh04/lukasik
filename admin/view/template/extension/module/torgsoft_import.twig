{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
        <button type="submit" form="form-torgsoft" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
        <a href="{{ import_url }}" class="btn btn-success"><i class="fa fa-download"></i> {{ text_button_import }}</a>
        <a href="{{ test_url }}" class="btn btn-warning"><i class="fa fa-flask"></i> {{ text_button_test }}</a>
        <a href="{{ refresh_log_url }}" class="btn btn-default"><i class="fa fa-refresh"></i> {{ text_button_refresh_log }}</a>
        <a href="{{ clear_log_url }}" class="btn btn-danger"><i class="fa fa-trash"></i> {{ text_button_clear_log }}</a>
        <a href="{{ download_log_url }}" class="btn btn-info"><i class="fa fa-file-text-o"></i> {{ text_button_download_log }}</a>
      </div>
      <h1>{{ heading_title }}</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
          <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <div class="container-fluid">
    {% if error_warning %}
      <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
        <button type="button" class="close" data-dismiss="alert">&times;</button>
      </div>
    {% endif %}
    {% if success %}
      <div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> {{ success }}
        <button type="button" class="close" data-dismiss="alert">&times;</button>
      </div>
    {% endif %}

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-cogs"></i> {{ text_edit }}</h3>
      </div>
      <div class="panel-body">
        <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-torgsoft" class="form-horizontal">

          <ul class="nav nav-tabs">
            <li class="active"><a href="#tab-settings" data-toggle="tab">{{ text_tab_settings }}</a></li>
            <li><a href="#tab-fields" data-toggle="tab">{{ text_tab_fields }}</a></li>
            <li><a href="#tab-log" data-toggle="tab">{{ text_tab_log }}</a></li>
            <li><a href="#tab-help" data-toggle="tab">{{ text_tab_help }}</a></li>
          </ul>

          <div class="tab-content">

            <div class="tab-pane active" id="tab-settings">
              <div class="form-group">
                <label class="col-sm-2 control-label" for="status">{{ entry_status }}</label>
                <div class="col-sm-10">
                  <select name="module_torgsoft_import_status" id="status" class="form-control">
                    <option value="1" {{ module_torgsoft_import_status ? 'selected' : '' }}>{{ text_enabled }}</option>
                    <option value="0" {{ not module_torgsoft_import_status ? 'selected' : '' }}>{{ text_disabled }}</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-2 control-label">{{ entry_xml_path }}</label>
                <div class="col-sm-10">
                  <input type="text" name="module_torgsoft_import_xml_path" value="{{ module_torgsoft_import_xml_path }}" class="form-control"/>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-2 control-label">{{ entry_images_path }}</label>
                <div class="col-sm-10">
                  <input type="text" name="module_torgsoft_import_images_path" value="{{ module_torgsoft_import_images_path }}" class="form-control"/>
                  <p class="help-block">Пример: /home/site/www/img/ (файлы GoodID.jpg, GoodID_1.jpg ...)</p>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-2 control-label">{{ entry_brand_fallback }}</label>
                <div class="col-sm-10">
                  <input type="text" name="module_torgsoft_import_brand_fallback" value="{{ module_torgsoft_import_brand_fallback }}" class="form-control"/>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-2 control-label">{{ entry_image_limit }}</label>
                <div class="col-sm-10">
                  <input type="number" name="module_torgsoft_import_image_limit" value="{{ module_torgsoft_import_image_limit }}" class="form-control" min="1" max="50"/>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-2 control-label">Cron</label>
                <div class="col-sm-10">
                  <input type="text" readonly class="form-control" value="{{ module_torgsoft_import_cron_url }}"/>
                  <p class="help-block">Добавьте в планировщик (curl или wget).</p>
                </div>
              </div>
            </div>

            <div class="tab-pane" id="tab-fields">
              <fieldset>
                <legend>Группы данных</legend>
                <div class="checkbox">
                  <label><input type="checkbox" name="module_torgsoft_import_update_categories" value="1" {{ module_torgsoft_import_update_categories ? 'checked' : '' }}> {{ entry_update_categories }}</label>
                </div>
                <div class="checkbox">
                  <label><input type="checkbox" name="module_torgsoft_import_update_manufacturers" value="1" {{ module_torgsoft_import_update_manufacturers ? 'checked' : '' }}> {{ entry_update_manufacturers }}</label>
                </div>
                <div class="checkbox">
                  <label><input type="checkbox" name="module_torgsoft_import_update_products" value="1" {{ module_torgsoft_import_update_products ? 'checked' : '' }}> {{ entry_update_products }}</label>
                </div>
              </fieldset>
              <hr/>
              <fieldset>
                <legend>Поля товаров</legend>
                <div class="row">
                  <div class="col-sm-6">
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_name" value="1" {{ module_torgsoft_import_update_name ? 'checked' : '' }}> {{ entry_update_name }}</label></div>
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_description" value="1" {{ module_torgsoft_import_update_description ? 'checked' : '' }}> {{ entry_update_description }}</label></div>
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_price" value="1" {{ module_torgsoft_import_update_price ? 'checked' : '' }}> {{ entry_update_price }}</label></div>
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_quantity" value="1" {{ module_torgsoft_import_update_quantity ? 'checked' : '' }}> {{ entry_update_quantity }}</label></div>
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_special" value="1" {{ module_torgsoft_import_update_special ? 'checked' : '' }}> {{ entry_update_special }}</label></div>
                  </div>
                  <div class="col-sm-6">
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_image" value="1" {{ module_torgsoft_import_update_image ? 'checked' : '' }}> {{ entry_update_image }}</label></div>
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_category" value="1" {{ module_torgsoft_import_update_category ? 'checked' : '' }}> {{ entry_update_category }}</label></div>
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_manufacturer" value="1" {{ module_torgsoft_import_update_manufacturer ? 'checked' : '' }}> {{ entry_update_manufacturer }}</label></div>
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_model" value="1" {{ module_torgsoft_import_update_model ? 'checked' : '' }} disabled> {{ entry_update_model }} <span class="help">(модель фиксируется GoodID)</span></label></div>
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_attributes" value="1" {{ module_torgsoft_import_update_attributes ? 'checked' : '' }}> {{ entry_update_attributes }}</label></div>
                    <div class="checkbox"><label><input type="checkbox" name="module_torgsoft_import_update_options" value="1" {{ module_torgsoft_import_update_options ? 'checked' : '' }}> {{ entry_update_options }}</label></div>
                  </div>
                </div>
              </fieldset>
            </div>

            <div class="tab-pane" id="tab-log">
              {% if log_created %}
                <pre style="max-height:420px; overflow:auto; background:#111; color:#0f0; padding:10px;">{{ log_content }}</pre>
              {% else %}
                <div class="alert alert-info">{{ text_log_empty }}</div>
              {% endif %}
            </div>

            <div class="tab-pane" id="tab-help">
              <div class="alert alert-info">
                <p><b>Фото:</b> основное — <code>GoodID.jpg</code>, дополнительные — <code>GoodID_1.jpg ... GoodID_N.jpg</code>. Путь задайте в настройках.</p>
                <p><b>Категории:</b> создаются по узлам <code>&lt;category id=... parentId=...&gt;Имя&lt;/category&gt;</code>.</p>
                <p><b>Идентификация товара:</b> по <code>GoodID</code> (записывается в <i>model</i>).</p>
              </div>
            </div>

          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{{ footer }}
